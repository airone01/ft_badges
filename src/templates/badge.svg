<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200">
  <defs>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="3" stdDeviation="3" flood-color="#000000" flood-opacity="0.3"/>
    </filter>

    {% if variant == 'noisy' %}
    <linearGradient id="bgGrad" x1="0%" y1="100%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="{{ grad1 }}"/> 
      <stop offset="50%" stop-color="{{ grad2 }}"/> 
      <stop offset="100%" stop-color="{{ grad3 }}"/> 
    </linearGradient>

    <linearGradient id="rayGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#ffffff" stop-opacity="1"/>
      <stop offset="100%" stop-color="#88ffff" stop-opacity="0"/>
    </linearGradient>

    <filter id="rayBlur" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur stdDeviation="20" />
    </filter>

    <filter id="noiseOverlay" x="-10%" y="-10%" width="120%" height="120%" color-interpolation-filters="sRGB">
      <feTurbulence type="fractalNoise" baseFrequency="0.51" numOctaves="3" stitchTiles="stitch" result="noise" />
      <feColorMatrix type="matrix" values="1 0 0 0 0  1 0 0 0 0  1 0 0 0 0  0 0 0 1 0" in="noise" result="grayNoise" />
      <feComponentTransfer in="grayNoise" result="contrastyNoise">
        <feFuncR type="linear" slope="4" intercept="-1.5" />
        <feFuncG type="linear" slope="4" intercept="-1.5" />
        <feFuncB type="linear" slope="4" intercept="-1.5" />
        <feFuncA type="linear" slope="0.9" /> 
      </feComponentTransfer>
      <feBlend mode="overlay" in="contrastyNoise" in2="SourceGraphic" />
    </filter>

    <!-- mask shape -->
    <mask id="ring-mask">
      <rect width="200" height="200" fill="black" />
      {% if shape == 'round' %}
        <circle cx="100" cy="100" r="88" fill="none" stroke="white" stroke-width="8" />
      {% elif shape == 'pentagon' %}
        <polygon points="100,18 182,80 150,182 50,182 18,80" fill="none" stroke="white" stroke-width="8" stroke-linejoin="round" />
      {% elif shape == 'square' %}
        <rect x="12" y="12" width="176" height="176" rx="12" fill="none" stroke="white" stroke-width="8" />
      {% endif %}
    </mask>
    {% endif %}
  </defs>

  <!-- background shape -->
  {% if shape == 'round' %}
    <circle cx="100" cy="100" r="100" fill="{{ bg_color }}" />
  {% elif shape == 'pentagon' %}
    <polygon points="100,4 196,74 160,192 40,192 4,74" fill="{{ bg_color }}" stroke="{{ bg_color }}" stroke-width="8" stroke-linejoin="round" />
  {% elif shape == 'square' %}
    <rect width="200" height="200" rx="20" fill="{{ bg_color }}" />
  {% endif %}

  {% if variant == 'noisy' %}
    <g mask="url(#ring-mask)">
      <svg viewBox="0 0 800 800" width="200" height="200" x="0" y="0">
        <g filter="url(#noiseOverlay)">
          <rect width="100%" height="100%" fill="url(#bgGrad)" />
          <g filter="url(#rayBlur)">
            <path d="M -100,100 Q 300,200 900,-200" fill="none" stroke="url(#rayGrad)" stroke-width="40" opacity="0.9" />
            <path d="M -100,200 Q 400,300 900,-50" fill="none" stroke="url(#rayGrad)" stroke-width="20" opacity="0.8" />
            <path d="M -100,400 Q 400,600 1000,-100" fill="none" stroke="url(#rayGrad)" stroke-width="60" opacity="0.5" />
            <path d="M -50,550 Q 500,750 1000,50" fill="none" stroke="url(#rayGrad)" stroke-width="30" opacity="0.8" />
          </g>
        </g>
      </svg>
    </g>
  {% elif variant == 'classic' %}
    {% if shape == 'round' %}
      <circle cx="100" cy="100" r="88" fill="none" stroke="{{ accent_color }}" stroke-width="2" opacity="0.3" />
    {% elif shape == 'pentagon' %}
      <polygon points="100,18 182,80 150,182 50,182 18,80" fill="none" stroke="{{ accent_color }}" stroke-width="2" opacity="0.3" stroke-linejoin="round" />
    {% elif shape == 'square' %}
      <rect x="12" y="12" width="176" height="176" rx="12" fill="none" stroke="{{ accent_color }}" stroke-width="2" opacity="0.3" />
    {% endif %}
  {% endif %}

  {% if logo_style == 'logo' %}
    <g transform="translate(76, 30) scale(2)">
      <path fill="{{ text_color }}" opacity="0.5" d="M19.581 16.851H24v-4.439ZM24 3.574h-4.419v4.42l-4.419 4.418v4.44h4.419v-4.44L24 7.993Zm-4.419 0h-4.419v4.42zm-6.324 8.838H4.419l8.838-8.838H8.838L0 12.412v3.595h8.838v4.419h4.419z"/>
    </g>
  {% elif logo_style == 'text' %}
    <text x="100" y="60" font-family="monospace" font-size="20" font-weight="bold" fill="{{ text_color }}" text-anchor="middle" opacity="0.5">[ 42 ]</text>
  {% endif %}
  
  <text x="100" y="104" font-family="sans-serif" font-size="{{ name_data.font_size }}" font-weight="900" fill="{{ text_color }}" text-anchor="middle" filter="url(#shadow)">
    {% if name_data.is_multiline %}
      <tspan x="100" dy="0">{{ name_data.line1 }}</tspan>
      <tspan x="100" dy="22">{{ name_data.line2 }}</tspan>
    {% else %}
      <tspan x="100" dy="11">{{ name_data.line1 }}</tspan>
    {% endif %}
  </text>
  <text x="100" y="150" font-family="sans-serif" font-size="12" font-weight="bold" fill="{{ text_color }}" text-anchor="middle" opacity="0.6" letter-spacing="2">SCORE</text>
  <text x="100" y="172" font-family="monospace" font-size="22" font-weight="bold" fill="{{ accent_color }}" text-anchor="middle" filter="url(#shadow)">{{ score }}</text>
</svg>
